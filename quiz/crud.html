<!doctype html><html lang="en" class="h-100">
<head><meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Nowledge November Quiz</title>
<link rel="stylesheet" href="../lib/bootstrap.min.css">
<style>
.answer:hover{background:#eee}
.card{max-width:500px}
</style>
</head><body class="d-flex flex-column h-100">
<header>
<nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark py-0 border-bottom border-secondary shadow">
<div class="container-lg">
<a class="navbar-brand font-weight-bold mx-auto py-1" href="index.html">COMMERCE COUNCIL</a>
</div>
</nav>
</header>

<main class="flex-shrink-0 pt-5">




<div id="user" class="">
<div class="container-lg pt-4">

<div class="row gy-4">
<div class="col-sm-6">
<h1>Create, read and update and delete questions</h1>
<p>Here you can make real-time changes to Nowledge November Quiz.</p>

</div>
<div class="col-sm-6">
<div class="card mb-3 border-secondary shadow">
<span class="card-header h5">Submit Question</span>

<div class="card-body">
<label for="ques" class="form-label mb-0">Enter Question</label>
<textarea id="ques" class="form-control p-2" row="3" placeholder="Enter your question here..."></textarea>
<div class="form-text mb-3">Remaining Characters: <span id="quesCounter">0</span></div>

<label for="ans1" class="form-label mb-0">Choice 1.</label>
<input type="text" id="ans1" class="form-control p-2 mb-3" placeholder="Blue" />

<label for="ans2" class="form-label mb-0">Choice 2.</label>
<input type="text" id="ans2" class="form-control p-2 mb-3" placeholder="Blue" />

<label for="ans3" class="form-label mb-0">Choice 3.</label>
<input type="text" id="ans3" class="form-control p-2 mb-3" placeholder="Blue" />

<label for="ans4" class="form-label mb-0">Choice 4.</label>
<input type="text" id="ans4" class="form-control p-2 mb-3" placeholder="Blue" />

<label for="correct" class="form-label mb-0">Enter correct choice number</label>
<div class="input-group">
<span class="input-group-text">Correct Choice No.</span>
<input type="text" class="form-control" id="correct" placeholder="2">
</div>

</div>
<div class="card-footer">
<button id="submitBtn" class="btn btn-dark btn-block">Submit Question</button>
</div>
</div> <!-- card -->
</div>
</div> <!-- row -->

</div> <!-- container -->

<div class="container mt-4">
<ul class="pagination flex-wrap justify-content-center" id="paginationBtns">
</ul>
</div>

<div class="container-lg">
<div class="row" id="results_box"></div>
</div>

</div> <!-- user -->



</main>

<!-- footer start -->
<footer class="footer mt-auto pt-5 bg-dark text-muted text-center">
<div class="container">
<p>RexArvind Web Services &copy; <span id="copyYear">...</span></p>
</div>
</footer>
<!-- footer end -->
<script>
const _=id=>document.getElementById(id)
const ques=_("ques")
const quesCounter=_("quesCounter")
const submitBtn=_("submitBtn")
let pagination_controls=_("paginationBtns")
const results_box=_("results_box")
const ADD_URL=""
const COUNT_URL="https://ccvhpgc.000webhostapp.com/api/quiz/count.php"
const LIMIT_URL="https://ccvhpgc.000webhostapp.com/api/quiz/limit.php"

let uid
let totalRows;
var rpp = 1;

function request_page(pn){

var last = Math.ceil(totalRows/rpp);
if (last < 1){last = 1}

results_box.innerHTML = '<div class="text-center mb-5"><div class="spinner-border my-5" role="status"></div></div>';

  let fd=new FormData()
  fd.append("uid", uid)
  fd.append("rpp", rpp)
  fd.append("last", last)
  fd.append("pn", pn)

var xhr=new XMLHttpRequest();

xhr.open("POST", LIMIT_URL, true);


xhr.onreadystatechange = function() {
    if(xhr.readyState == 4 && xhr.status == 200) {
        var xhrRes=xhr.responseText;
        results_box.innerHTML=xhrRes
    }
}
xhr.send(fd);

var paginationCtrls = "";

if (last != 1){
    if (pn > 1){
        paginationCtrls += '<li class="page-item"><span onclick="request_page('+(pn-1)+')" class="page-link shadow-none">&lt;</span></li>';
        for(let i = pn-3; i < pn; i++){
            if(i > 0){
                paginationCtrls += '<li class="page-item"><span onclick="request_page('+i+')" class="page-link shadow-none">'+i+'</span></li>';
            }
        }
    }


    paginationCtrls += '<li class="page-item active"><span class="page-link shadow-none">'+pn+'</span></li>';


    for(let j = pn+1; j <= last; j++){
        paginationCtrls += '<li class="page-item"><span onclick="request_page('+j+')" class="page-link shadow-none">'+j+'</span></li>';
        if (j >= pn+3){
            break;
        }
    }
    if (pn != last){
        paginationCtrls += '<li class="page-item"><span onclick="request_page('+(pn+1)+')" class="page-link shadow-none">&gt;</span></li>';
    }
}
pagination_controls.innerHTML=paginationCtrls;
}




fetch(COUNT_URL).then(res=>res.text())
.then(res=>{totalRows=res

uid="oStUngGaR3egdhYNrmZGZfZxHIO2"
request_page(1);
})
.catch(err=>alert(err))









const shave=(str, n)=>
(str.length>n) ? str.substr(0, n-2)+'..' : str;


submitBtn.addEventListener("click", ()=>{
  let fd=new FormData()
  fd.append("uid", userID)
  fd.append("ques", shave(ques.value,250))
  fd.append("ans1", shave(ans1.value,250))
  fd.append("ans2", shave(ans2.value,250))
  fd.append("ans3", shave(ans3.value,250))
  fd.append("ans4", shave(ans4.value,250))
  var xhr=new XMLHttpRequest()
  xhr.open("POST", ADD_URL, true)
  xhr.onreadystatechange = function(){
    if(xhr.readyState==4 && xhr.status==200){
      resStatus=xhr.responseText
      alert(resStatus)
    }
  }
  xhr.onerror = function(){
    alert("Request Error...")
  }
  xhr.send(fd)
})


const date=new Date();
_("copyYear").innerText=date.getFullYear();
</script></body></html>